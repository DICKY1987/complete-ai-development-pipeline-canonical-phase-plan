{
  "$id": "schema/router_config.v1.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "RouterConfig v1",
  "description": "Configuration for task routing engine. Defines available tools and routing rules.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "version",
    "apps",
    "routing"
  ],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "Configuration version"
    },
    "apps": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "required": [
          "kind",
          "command",
          "capabilities"
        ],
        "properties": {
          "kind": {
            "type": "string",
            "enum": [
              "tool",
              "validator",
              "analyzer"
            ],
            "description": "Type of application"
          },
          "command": {
            "type": "string",
            "description": "Command to execute"
          },
          "capabilities": {
            "type": "object",
            "properties": {
              "task_kinds": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "domains": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "limits": {
            "type": "object",
            "properties": {
              "max_parallel": {
                "type": "integer"
              },
              "timeout_seconds": {
                "type": "integer"
              }
            }
          },
          "safety_tier": {
            "type": "string",
            "enum": [
              "low",
              "medium",
              "high"
            ]
          }
        }
      },
      "description": "Available applications/tools"
    },
    "routing": {
      "type": "object",
      "properties": {
        "rules": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "id",
              "match"
            ],
            "properties": {
              "id": {
                "type": "string"
              },
              "match": {
                "type": "object",
                "properties": {
                  "task_kind": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "risk_tier": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "complexity": {
                    "type": "string"
                  }
                }
              },
              "select_from": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "strategy": {
                "type": "string",
                "enum": [
                  "fixed",
                  "round_robin",
                  "auto"
                ]
              },
              "validate_with": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "required": {
                "type": "boolean"
              }
            }
          }
        }
      }
    },
    "defaults": {
      "type": "object",
      "properties": {
        "max_attempts": {
          "type": "integer"
        },
        "timeout_seconds": {
          "type": "integer"
        },
        "strategy": {
          "type": "string"
        }
      }
    }
  },
  "doc_id": "DOC-SPEC-ROUTER-CONFIG-V1-029"
}
