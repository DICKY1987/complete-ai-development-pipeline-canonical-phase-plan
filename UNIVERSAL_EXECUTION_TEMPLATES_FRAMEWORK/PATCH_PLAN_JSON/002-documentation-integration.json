[
  {
    "op": "add",
    "path": "/meta/patch_metadata/002",
    "value": {
      "patch_id": "002-documentation-integration",
      "patch_ulid": "01JDK8XWQP8PATCH002DOCS0001",
      "created_at": "2025-11-23T11:07:25.088Z",
      "description": "Integrate documentation patterns (AI tool config, sandbox strategy, ACS validation)",
      "source_files": [
        "docs/tools-instructions-config.md",
        "docs/soft-sandbox-pattern.md",
        "docs/DOCUMENTATION_INDEX.md",
        "docs/ACS_USAGE_GUIDE.md"
      ],
      "operations_count": 15,
      "priority": "CRITICAL",
      "approved_by": "human",
      "applied": false
    }
  },
  {
    "op": "add",
    "path": "/meta/ai_tool_configuration",
    "value": {
      "instruction_layers": {
        "global": {
          "claude": "~/.claude/CLAUDE.md",
          "codex": "~/.codex/AGENTS.md",
          "copilot": "GitHub account custom instructions"
        },
        "repo_level": {
          "claude": "./CLAUDE.md",
          "codex": "./AGENTS.md",
          "copilot": ".github/copilot-instructions.md"
        },
        "per_invocation": {
          "claude": "--system-prompt, --append-system-prompt",
          "codex": "prompt text",
          "copilot": "command prompt"
        }
      },
      "config_files": {
        "claude": ["~/.claude/settings.json", ".claude/settings.json"],
        "codex": ["~/.codex/config.toml"],
        "aider": [".aider.conf.yml"]
      }
    }
  },
  {
    "op": "add",
    "path": "/meta/tool_instruction_files_required",
    "value": ["CLAUDE.md", "AGENTS.md", ".github/copilot-instructions.md"]
  },
  {
    "op": "add",
    "path": "/meta/sandbox_strategy",
    "value": {
      "pattern": "soft_sandbox",
      "sandbox_roots": {
        "windows": "C:\\Users\\richg\\AI_SANDBOX",
        "wsl": "~/ai-sandbox"
      },
      "clone_pattern": "{repo}_sandbox",
      "branch_pattern": "ai-sandbox/*",
      "rules": [
        "AI tools run only in sandbox clones",
        "Experimental changes on ai-sandbox/* branches",
        "Stable changes promoted to main repo"
      ]
    }
  },
  {
    "op": "add",
    "path": "/meta/documentation_structure",
    "value": {
      "index": "docs/DOCUMENTATION_INDEX.md",
      "categories": ["getting_started", "architecture_decisions", "reference", "guidelines", "ai_agents"],
      "acs_artifacts": ["CODEBASE_INDEX.yaml", "QUALITY_GATE.yaml", "ai_policies.yaml", ".aiignore", ".meta/AI_GUIDANCE.md"],
      "generated_context": [".meta/ai_context/repo_summary.json", ".meta/ai_context/code_graph.json"]
    }
  },
  {
    "op": "add",
    "path": "/meta/future_ai_techniques",
    "value": {
      "repository_mapping": {"technique": "AST + PageRank", "priority": "HIGH", "effort_hours": 16},
      "graph_rag": {"technique": "Knowledge Graph", "priority": "MEDIUM", "effort_hours": 24},
      "reflexion_loops": {"technique": "Runtime self-correction", "priority": "HIGH", "effort_hours": 12},
      "raptor_indexing": {"technique": "Hierarchical indexing", "priority": "MEDIUM", "effort_hours": 20}
    }
  },
  {
    "op": "add",
    "path": "/validation/documentation_gates",
    "value": {
      "acs_conformance": {"command": "python scripts/validate_acs_conformance.py", "required": true},
      "code_graph_acyclic": {"command": "python scripts/generate_code_graph.py --validate", "required": true}
    }
  },
  {
    "op": "add",
    "path": "/phases/PH-000/pre_flight_checks",
    "value": {
      "sandbox_available": {
        "windows": "Test-Path C:\\Users\\richg\\AI_SANDBOX",
        "wsl": "test -d ~/ai-sandbox"
      },
      "git_config": {"user_name": "git config user.name", "user_email": "git config user.email"}
    }
  },
  {
    "op": "replace",
    "path": "/phases/PH-000/estimated_duration_hours",
    "value": 6.0
  },
  {
    "op": "add",
    "path": "/phases/PH-000/workstreams/WS-000-007",
    "value": {
      "workstream_id": "WS-000-007",
      "workstream_ulid": "01JDK8XWQP8WS000007AICONF1",
      "name": "AI Tool Instruction Files",
      "phase_id": "PH-000",
      "priority": "HIGH",
      "estimated_duration_hours": 1.5,
      "dependencies": [],
      "tasks": {
        "TSK-000-007-001": {
          "task_id": "TSK-000-007-001",
          "task_ulid": "01JDK8XWQP8TSK000007001CLA",
          "name": "Create CLAUDE.md",
          "workstream_id": "WS-000-007",
          "executor": "file_create",
          "inputs": {"file_path": {"type": "string", "default": "CLAUDE.md"}},
          "outputs": {"file_created": {"type": "boolean"}},
          "file_scope": {
            "create": ["CLAUDE.md"],
            "modify": [],
            "read_only": ["AGENTS.md", ".github/copilot-instructions.md"]
          },
          "acceptance_tests": {
            "powershell": "Test-Path CLAUDE.md",
            "pytest": null
          },
          "max_runtime_seconds": 300,
          "idempotent": true
        },
        "TSK-000-007-002": {
          "task_id": "TSK-000-007-002",
          "task_ulid": "01JDK8XWQP8TSK000007002AGT",
          "name": "Update AGENTS.md for Codex",
          "workstream_id": "WS-000-007",
          "executor": "file_edit",
          "inputs": {"file_path": {"type": "string", "default": "AGENTS.md"}},
          "file_scope": {
            "create": [],
            "modify": ["AGENTS.md"],
            "read_only": ["CLAUDE.md"]
          },
          "acceptance_tests": {
            "powershell": "Test-Path AGENTS.md",
            "pytest": null
          },
          "max_runtime_seconds": 300,
          "idempotent": true,
          "dependencies": ["TSK-000-007-001"]
        },
        "TSK-000-007-003": {
          "task_id": "TSK-000-007-003",
          "task_ulid": "01JDK8XWQP8TSK000007003COP",
          "name": "Verify .github/copilot-instructions.md",
          "workstream_id": "WS-000-007",
          "executor": "validation",
          "command": "Test-Path .github/copilot-instructions.md",
          "file_scope": {
            "create": [],
            "modify": [],
            "read_only": [".github/copilot-instructions.md"]
          },
          "acceptance_tests": {
            "powershell": "Test-Path .github/copilot-instructions.md",
            "pytest": null
          },
          "max_runtime_seconds": 30,
          "idempotent": true,
          "dependencies": []
        }
      },
      "completion_criteria": {
        "all_tasks_complete": true,
        "all_instruction_files_exist": true
      }
    }
  }
]
