{
  "phase_id": "PH-3A",
  "workstream_id": "WS-ORCHESTRATION",
  "phase_name": "WORKSTREAM_V1.1 Prompt Renderer",
  "objective": "Build prompt renderer that generates WORKSTREAM_V1.1 format prompts from phase specs with embedded context",
  "dependencies": ["PH-1F"],
  "file_scope": [
    "src/prompt_renderer.py",
    "templates/workstream_v1.1.txt",
    "tests/test_prompt_renderer.py"
  ],
  "pre_flight_checks": [
    {
      "check_id": "PFC-3A-001",
      "description": "Spec renderer exists",
      "command": "test -f src/spec_renderer.py",
      "expected": "exit code 0"
    }
  ],
  "acceptance_tests": [
    {
      "test_id": "AT-3A-001",
      "description": "Renders valid WORKSTREAM_V1.1 prompt",
      "command": "python src/prompt_renderer.py --phase phase_specs/phase_0_bootstrap.json --output prompt.txt",
      "expected": "creates ASCII-only prompt with all required sections"
    },
    {
      "test_id": "AT-3A-002",
      "description": "Includes phase objective in prompt",
      "command": "python src/prompt_renderer.py --phase phase_specs/phase_1a_universal_spec.json | grep -q 'OBJECTIVE:'",
      "expected": "exit code 0"
    },
    {
      "test_id": "AT-3A-003",
      "description": "Embeds relevant spec sections as context",
      "command": "python src/prompt_renderer.py --phase phase_specs/phase_2a_schema_validator.json --embed-specs | grep -q 'UPS-'",
      "expected": "exit code 0, includes spec IDs"
    },
    {
      "test_id": "AT-3A-004",
      "description": "Includes acceptance tests as completion criteria",
      "command": "python src/prompt_renderer.py --phase phase_specs/phase_0_bootstrap.json | grep -c 'ACCEPTANCE_TEST'",
      "expected": "count matches number of tests in spec"
    },
    {
      "test_id": "AT-3A-005",
      "description": "Renders pre-flight checks section",
      "command": "python src/prompt_renderer.py --phase phase_specs/phase_1d_cross_reference.json | grep -q 'PRE_FLIGHT_CHECKS'",
      "expected": "exit code 0"
    },
    {
      "test_id": "AT-3A-006",
      "description": "Unit tests pass",
      "command": "pytest tests/test_prompt_renderer.py -v",
      "expected": "all tests pass (>= 10 tests)"
    }
  ],
  "deliverables": [
    "src/prompt_renderer.py with WORKSTREAM_V1.1 template",
    "templates/workstream_v1.1.txt template file",
    "tests/test_prompt_renderer.py"
  ],
  "estimated_effort_hours": 8,
  "risk_level": "medium",
  "notes": "Core component for AI agent instruction generation"
}
