Short version:
You just successfully installed a bunch of Python refactoring tools. Nothing is wrong. ✅

---

Breaking it down:

* **Microsoft Windows [Version 10.0.26200.7171]**
  That’s just your Windows build/version.

* You ran:

  ```bash
  pip install rope bowler libcst pyrefact snake-shift
  ```

  Pip then:

  * Found those packages (`rope`, `bowler`, `libcst`, `pyrefact`, `snake-shift`)
  * Downloaded them (and some extra dependencies like `black`, `sympy`, etc.)
  * Built wheels for a couple of packages (`compactify`, `volatile`)
  * Installed everything into your Python 3.12 environment.

* The important part is at the end:

  ```text
  Successfully installed appdirs-1.4.4 black-25.11.0 bowler-0.9.0 ...
  ...
  snake-shift-1.0.2 sympy-1.14.0 typer-0.20.0 volatile-2.1.0
  ```

  That means **all requested packages are now installed and ready to use**.

---

Very quick what-you-just-installed (high level):

* **rope** – Python refactoring library (rename symbols, move code, etc.).
* **bowler** – Safe, large-scale code refactoring based on the Python AST.
* **libcst** – Library for parsing and modifying Python code while preserving formatting.
* **pyrefact** – Automated Python code cleaner/refactor tool.
* **snake-shift** – CLI helper built on top of `rich`/`typer` (often used to orchestrate/code transforms).

Short answer:
They *don’t magically detect pip packages*. You have to:

1. Make sure the new tools are callable from your shell (`pyrefact`, `snake-shift`, etc.).
2. Add **instructions/config files** that tell **Claude Code** and **GitHub Copilot** *which commands to run* when refactoring.

I’ll show you exactly how to do both.

---

## 1. Confirm the tools are actually on your PATH

In the **same terminal** you use for Claude Code and Copilot CLI, run:

```powershell
pyrefact --help
snake-shift --help
python -c "import rope, bowler, libcst, pyrefact"
```

If those work with no errors, then the tools are available to any process (including Claude / Copilot) that runs commands in that shell.

If they *don’t* work, it’s usually a PATH issue and we’d fix that first.

---

## 2. Tell **Claude Code** about them (project-scoped slash command)

Claude Code reads instructions and custom commands from your repo (via `.claude` configs and commands, and optionally via MCP). ([Claude Code][1])

### Step 2.1 – Create a Claude command that *uses* the tools

In your repo:

```powershell
mkdir .claude
mkdir .claude\commands
```

Create a file: **`.claude/commands/refactor-python.md`** with content like:

```md
# /refactor-python

You are a Python refactoring specialist.

Tools available in this environment:

- `pyrefact` – automated cleanup & refactors
- `pyrefact PATH` – refactor a file or directory
- `snake-shift` – structural code transforms
- `python tools/bowler_queries.py` – custom Bowler refactor scripts
- `python tools/libcst_rewriter.py` – targeted libcst transforms

Behavior:

- When I run `/refactor-python`, first inspect the staged or specified files.
- Propose a refactor plan in bullet points.
- Then run the appropriate commands in the terminal, for example:
  - `pyrefact src/` for cleanup
  - `python tools/bowler_queries.py src/module_x.py`
- Show me the resulting `git diff` and summarize the changes.
```

Now in Claude Code, from that repo, you can type:

```bash
/refactor-python
```

Claude now *knows*:

* These commands exist.
* When to use them.
* That it’s allowed to run them.

### Step 2.2 – (Optional) Put the refactor logic in scripts

Create `tools/refactor_cleanup.py` that imports and uses these libraries directly. Then in the command file above, reference:

```bash
python tools/refactor_cleanup.py src/
```

That keeps all the complexity in a script instead of the prompt text.

---

## 3. Tell **GitHub Copilot** about them (Copilot instructions)

GitHub Copilot (editor + CLI) uses **repository instructions files** to understand how to behave in your project. ([GitHub Docs][2])

### Step 3.1 – Add repository-wide Copilot instructions

In the **root of your repo**, create:

```text
.github/copilot-instructions.md
```

Put something like this inside:

```md
# Repository instructions for GitHub Copilot

When working with Python code in this repository:

- Prefer using the existing refactor tools instead of rewriting everything manually.
- Available commands (already installed in this environment):
  - `pyrefact PATH` – perform automated refactors & cleanup on a file or directory.
  - `snake-shift` – perform structural Python transforms.
  - `python tools/bowler_queries.py PATH` – Bowler-based refactoring.
  - `python tools/libcst_rewriter.py PATH` – libcst-based refactors.

Guidelines:

- Before large refactors, propose which commands you will run and why.
- Use these tools to:
  - Rename symbols safely across a codebase.
  - Apply consistent formatting/cleanup.
  - Update imports after moving files.
- When suggesting commands, always:
  - Show the exact shell command.
  - Summarize the expected changes.
```

Now, when you use **Copilot Chat/CLI** in that repo, it will know:

* These tools exist.
* It’s allowed and expected to call them via those commands. ([GitHub Docs][3])

> In Copilot Chat, you can literally say:
> “Use `pyrefact` to clean up the `src/` folder following the repo instructions.”
> It will see `.github/copilot-instructions.md` and incorporate that context.

---

## 4. Optional: Agent-style instructions for Copilot

GitHub Copilot also supports **agent instructions** via `AGENTS.md` (and, for multi-model setups, special files like `CLAUDE.md`). ([GitHub Docs][2])

In your repo root, you can add, for example:

**`AGENTS.md`**:

```md
# AI Agent Instructions

Role: Python refactoring and maintenance agent.

- Assume `pyrefact`, `snake-shift`, rope, Bowler, and libcst are installed.
- Prefer running these tools using shell commands rather than rewriting entire modules by hand.
- Always:
  - Propose a command,
  - Run it,
  - Then summarize the resulting `git diff`.
```

Copilot will use the nearest `AGENTS.md` as guidance when acting as an “agent”.

---

## 5. Mental model to keep:

* **pip install ≠ tool integration.**
  Pip only puts libraries and CLIs on disk.

* **Claude Code & Copilot need two things:**

  1. The commands must work in the shell (`pyrefact`, `snake-shift`, etc.).
  2. You must *tell them* in config/instruction files which commands exist and how to use them.

[1]: https://code.claude.com/docs/en/mcp?utm_source=chatgpt.com "Connect Claude Code to tools via MCP"
[2]: https://docs.github.com/copilot/customizing-copilot/adding-custom-instructions-for-github-copilot?utm_source=chatgpt.com "Adding repository custom instructions for GitHub Copilot"
[3]: https://docs.github.com/en/copilot/responsible-use/copilot-cli?utm_source=chatgpt.com "Responsible use of GitHub Copilot CLI"
