{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://uet.dev/schemas/atomic_create.v1.json",
  "title": "Atomic Create Pattern Instance Schema",
  "description": "Schema for atomic_create pattern instances - creates 1-3 files with tests",
  "type": "object",
  "required": [
    "pattern_id",
    "project_root",
    "files_to_create"
  ],
  "properties": {
    "pattern_id": {
      "type": "string",
      "const": "PAT-ATOMIC-CREATE-001",
      "description": "Must match the atomic_create pattern ID"
    },
    "project_root": {
      "type": "string",
      "minLength": 1,
      "description": "Absolute path to project root directory",
      "examples": [
        "C:\\Projects\\MyApp",
        "/home/user/projects/myapp"
      ]
    },
    "files_to_create": {
      "type": "array",
      "minItems": 1,
      "maxItems": 3,
      "description": "List of files to create (1-3 files max)",
      "items": {
        "type": "object",
        "required": [
          "path",
          "file_type"
        ],
        "properties": {
          "path": {
            "type": "string",
            "minLength": 1,
            "description": "Relative path from project_root",
            "pattern": "^[^\\\\/:*?\"<>|]+(/[^\\\\/:*?\"<>|]+)*\\.[a-zA-Z0-9]+$",
            "examples": [
              "src/utils/helper.py",
              "tests/test_helper.py",
              "lib/formatter.js"
            ]
          },
          "file_type": {
            "type": "string",
            "enum": [
              "implementation",
              "test"
            ],
            "description": "Type of file to create"
          },
          "purpose": {
            "type": "string",
            "description": "Brief description of file purpose",
            "maxLength": 200,
            "examples": [
              "String manipulation utilities",
              "Test suite for helper functions"
            ]
          },
          "content_template": {
            "type": "string",
            "description": "Optional template name to use",
            "enum": [
              "python_module",
              "python_class",
              "javascript_module",
              "typescript_module",
              "powershell_module"
            ]
          }
        },
        "additionalProperties": false
      }
    },
    "language": {
      "type": "string",
      "enum": [
        "python",
        "javascript",
        "typescript",
        "powershell"
      ],
      "default": "python",
      "description": "Programming language for files"
    },
    "test_framework": {
      "type": "string",
      "description": "Testing framework to use",
      "examples": [
        "pytest",
        "jest",
        "pester"
      ]
    },
    "include_type_hints": {
      "type": "boolean",
      "default": true,
      "description": "Include type hints (Python/TypeScript)"
    },
    "include_docstrings": {
      "type": "boolean",
      "default": true,
      "description": "Include comprehensive docstrings"
    },
    "metadata": {
      "type": "object",
      "description": "Optional metadata for tracking",
      "properties": {
        "created_by": {
          "type": "string",
          "description": "User or tool that created this instance"
        },
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when instance was created"
        },
        "workstream_id": {
          "type": "string",
          "pattern": "^WS-[A-Z0-9]+-\\d{3}$",
          "description": "Associated workstream ID (if any)"
        },
        "phase_id": {
          "type": "string",
          "pattern": "^PH-[A-Z0-9]+-\\d{2}$",
          "description": "Associated phase ID (if any)"
        }
      }
    }
  },
  "additionalProperties": false,
  "allOf": [
    {
      "description": "Must have at least one implementation file",
      "properties": {
        "files_to_create": {
          "contains": {
            "type": "object",
            "properties": {
              "file_type": {
                "const": "implementation"
              }
            }
          }
        }
      }
    },
    {
      "description": "Must have at least one test file",
      "properties": {
        "files_to_create": {
          "contains": {
            "type": "object",
            "properties": {
              "file_type": {
                "const": "test"
              }
            }
          }
        }
      }
    }
  ],
  "examples": [
    {
      "pattern_id": "PAT-ATOMIC-CREATE-001",
      "project_root": "C:\\Projects\\MyApp",
      "files_to_create": [
        {
          "path": "src/utils/string_helper.py",
          "file_type": "implementation",
          "purpose": "String manipulation utilities"
        },
        {
          "path": "tests/test_string_helper.py",
          "file_type": "test",
          "purpose": "Test suite for string_helper"
        }
      ],
      "language": "python",
      "test_framework": "pytest",
      "include_type_hints": true,
      "include_docstrings": true
    },
    {
      "pattern_id": "PAT-ATOMIC-CREATE-001",
      "project_root": "/home/user/projects/webapp",
      "files_to_create": [
        {
          "path": "src/utils/validator.py",
          "file_type": "implementation",
          "purpose": "Input validation functions"
        },
        {
          "path": "tests/test_validator.py",
          "file_type": "test",
          "purpose": "Validation tests"
        }
      ],
      "language": "python",
      "test_framework": "pytest"
    }
  ],
  "doc_id": "DOC-PAT-ATOMIC-CREATE-SCHEMA-108"
}
