{
  "$id": "schema/project_profile.v1.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ProjectProfile v1",
  "description": "Project-specific configuration generated during bootstrap. Defines domain, profile, tools, and constraints.",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "project_id",
    "project_name",
    "project_root",
    "domain",
    "profile_id",
    "resource_types",
    "available_tools",
    "framework_paths",
    "constraints"
  ],
  "properties": {
    "project_id": {
      "type": "string",
      "minLength": 1,
      "description": "Unique project identifier"
    },
    "project_name": {
      "type": "string",
      "minLength": 1,
      "description": "Human-readable project name"
    },
    "project_root": {
      "type": "string",
      "minLength": 1,
      "description": "Absolute path to project root"
    },
    "domain": {
      "type": "string",
      "enum": [
        "software-dev",
        "data-pipeline",
        "operations",
        "documentation",
        "mixed"
      ],
      "description": "Primary domain of this project"
    },
    "profile_id": {
      "type": "string",
      "minLength": 1,
      "description": "Profile this project uses"
    },
    "profile_version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "Version of the profile"
    },
    "resource_types": {
      "type": "object",
      "description": "Configuration for resource types in this project",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "root": {
            "type": "string",
            "description": "Root path for this resource type"
          },
          "tracked_by": {
            "type": "string",
            "description": "Tracking system (git, etc.)"
          },
          "exclusions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Patterns to exclude"
          }
        }
      }
    },
    "available_tools": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "tool_id",
          "command",
          "capabilities"
        ],
        "properties": {
          "tool_id": {
            "type": "string",
            "description": "Tool identifier"
          },
          "command": {
            "type": "string",
            "description": "Command to invoke tool"
          },
          "capabilities": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "What this tool can do"
          },
          "max_parallel": {
            "type": "integer",
            "minimum": 1,
            "description": "Max parallel invocations"
          }
        }
      },
      "description": "Tools detected/configured for this project"
    },
    "framework_paths": {
      "type": "object",
      "required": [
        "tasks_dir",
        "ledger_dir",
        "worktrees_dir",
        "quarantine_dir",
        "registry_file"
      ],
      "description": "Framework directory structure",
      "properties": {
        "tasks_dir": {
          "type": "string",
          "description": "Task queue directory"
        },
        "ledger_dir": {
          "type": "string",
          "description": "Ledger storage directory"
        },
        "worktrees_dir": {
          "type": "string",
          "description": "Git worktrees directory"
        },
        "quarantine_dir": {
          "type": "string",
          "description": "Quarantine directory"
        },
        "registry_file": {
          "type": "string",
          "description": "Project registry file"
        }
      }
    },
    "constraints": {
      "type": "object",
      "description": "Global constraints from profile + inference",
      "properties": {
        "patch_only": {
          "type": "boolean",
          "default": true
        },
        "tests_must_pass": {
          "type": "boolean",
          "default": true
        },
        "ascii_only": {
          "type": "boolean",
          "default": true
        },
        "max_lines_changed": {
          "type": "integer",
          "minimum": 1
        },
        "max_files_changed": {
          "type": "integer",
          "minimum": 1
        },
        "require_issue_ref": {
          "type": "boolean"
        }
      }
    },
    "framework_version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "Framework version this project uses"
    }
  },
  "doc_id": "DOC-SPEC-PROJECT-PROFILE-V1-027"
}
