module: "core.bootstrap"
purpose: "Bootstrap: auto-discover projects, select profiles, generate PROJECT_PROFILE.yaml + router_config.json"
layer: "domain"

entry_points:
  - file: "orchestrator.py"
    function: "BootstrapOrchestrator"
    description: "Main bootstrap coordinator - runs discovery → selection → generation → validation"

  - file: "discovery.py"
    function: "discover_project()"
    description: "Scan project directory, detect languages, frameworks, structure"

  - file: "selector.py"
    function: "select_profile()"
    description: "Choose profile type (python, data, docs, ops, generic) based on discovery"

  - file: "generator.py"
    function: "generate_artifacts()"
    description: "Create PROJECT_PROFILE.yaml and router_config.json from template"

key_patterns:
  - "Bootstrap runs once per project to generate configuration"
  - "Discovery scans for languages, frameworks, test directories, build files"
  - "Selector chooses profile based on majority language + detected frameworks"
  - "Generator uses Jinja2 templates from profiles/ directory"
  - "Validator ensures generated artifacts conform to schemas"

common_tasks:
  - task: "Bootstrap new project"
    code: |
      from core.bootstrap.orchestrator import BootstrapOrchestrator
      bo = BootstrapOrchestrator(project_root="/path/to/project")
      result = bo.bootstrap()
      # Generates PROJECT_PROFILE.yaml + router_config.json
    approach: "Create BootstrapOrchestrator, call bootstrap()"

  - task: "Manual discovery only"
    code: |
      from core.bootstrap.discovery import discover_project
      report = discover_project("/path/to/project")
      print(report.languages, report.frameworks)
    approach: "Call discover_project() without full bootstrap"

gotchas:
  - "Bootstrap overwrites existing PROJECT_PROFILE.yaml - back up first"
  - "Discovery skips hidden directories (.git, .venv, node_modules)"
  - "Selector defaults to 'generic' if no clear match found"
  - "Generated configs need manual review before use"
  - "Bootstrap is designed for greenfield projects, not legacy codebases"

dependencies:
  external:
    - "pyyaml"
    - "jinja2"
  internal:
    - "core.state.db (for discovery results)"

status:
  maturity: "stable"
  test_coverage: "85%"
  production_ready: true
  breaking_changes_expected: false

ai_quick_reference:
  bootstrap: "BootstrapOrchestrator(project_root).bootstrap()"
  discover: "discover_project(project_root)"
  select: "select_profile(discovery_report)"
  generate: "generate_artifacts(profile_type, project_root)"
